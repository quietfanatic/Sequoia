<!DOCTYPE html>
<html><head>

<title>Sequoia Shell</title>
<style>
#toolbar { display:flex; align-items:center; position:absolute; left:0; top:0; right:0; height:32px; border-bottom:2px solid; }
button { border:none; background:none; }
#address { flex-grow:1; height:28px; padding-left:0.4rem; padding-right:0.4rem; border:none; }
#tree { position:absolute; right:0; top:34px; width:120px; bottom:0; border-left:2px solid; }
</style>

</head><body>

<nav id="toolbar">
<button id="back">&lt;</button>
<button id="forward">&gt;</button>
<input id="address" />
<button id="menu">...</button>
</nav>

<nav id="tree"></nav>

<div id="content"></div>

<script>
"use strict";

let host = window.chrome.webview;

let $tree = document.getElementById("tree");

let $back = document.getElementById("back");
$back.addEventListener("click", e=>{
    host.postMessage({"back":null});
});

let $forward = document.getElementById("forward");
$forward.addEventListener("click", e=>{
    host.postMessage({"forward":null});
});

let $address = document.getElementById("address");
$address.addEventListener("keydown", e=>{
    if (e.key == "Enter") {
        host.postMessage(["navigate", $address.value]);
    }
});

let commands = {
    update (url, back, forward) {
        $address.value = url;
        $back.enabled = back;
        $forward.enabled = forward;
    },
};

host.addEventListener("message", e=>{
    if (e.data.length < 1) {
        console.log("Shell received unrecognized message format");
        return;
    }
    let command = e.data.shift();
    if (command in commands) {
        commands[command].apply(undefined, e.data)
    }
    else {
        console.log("Shell received unknown message");
    }
});

host.postMessage(["ready"]);
</script>

</body></html>
